{
  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/common/bundle.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "bundle",
  "description": "A Bundle is a collection of arbitrary STIX Objects and Marking Definitions grouped together in a single container.",
  "type": "object",
  "properties": {
    "type": {
      "type": "string",
      "description": "The type of this object, which MUST be the literal `bundle`.",
      "enum": [
        "bundle"
      ]
    },
    "id": {
      "allOf": [
        {
          "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/common/identifier.json",
          "description": "An identifier for this bundle. The id field for the Bundle is designed to help tools that may need it for processing, but tools are not required to store or track it. "
        },
        {
          "title": "id",
          "pattern": "^bundle--"
        }
      ]
    },
    "spec_version": {
      "type": "string",
      "enum": [
        "2.0"
      ],
      "description": "The version of the STIX specification used to represent the content in this bundle."
    },
    "objects": {
      "type": "array",
      "description": "Specifies a set of one or more STIX Objects.",
      "items": {
        "anyOf": [
          {
            "oneOf": [
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/attack-pattern.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/campaign.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/course-of-action.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/identity.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/indicator.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/intrusion-set.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/malware.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/common/marking-definition.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/observed-data.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sros/relationship.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/report.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sros/sighting.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/threat-actor.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/tool.json"
              },
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/vulnerability.json"
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/common/core.json"
              },
              {
                "properties": {
                  "type": {
                    "type": "string",
                    "description": "The type of this object, which for custom objects cannot be one of those defined in the specification.",
                    "not": {
                      "enum": [
                        "attack-pattern",
                        "campaign",
                        "course-of-action",
                        "identity",
                        "indicator",
                        "intrusion-set",
                        "malware",
                        "marking-definition",
                        "observed-data",
                        "relationship",
                        "report",
                        "sighting",
                        "threat-actor",
                        "tool",
                        "vulnerability"
                      ]
                    }
                  }
                }
              }
            ]
          }
        ]
      },
      "minItems": 1
    }
  },
  "required": [
    "type",
    "id",
    "spec_version"
  ]
}
